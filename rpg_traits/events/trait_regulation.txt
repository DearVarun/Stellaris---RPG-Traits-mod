namespace = trait_regulation

## eight attempt at removing traits

event = {
	id = trait_regulation.1
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_country = {
			limit = { is_ai = yes }
			country_event = { id = trait_regulation.2 }
		}
	}
}


country_event = {
	id = trait_regulation.2
	hide_window = no
	title = Regulation
	desc = KABOOM
	picture = GFX_evt_ship_in_orbit
	is_triggered_only = yes

	immediate = {
			limit = { is_ai = yes }
			random_list = {
				99 = {
					every_owned_pop = {
						modify_species = {
							species = this
							remove_trait = trait_titanic
						}
					}
					
					every_owned_planet = { 
						if = { 
							limit = { has_spaceport = yes }
							destroy_fleet = spaceport
						}
			create_spaceport = {
				owner = root
				initial_module = "laser_weapon"
			}
					}
					
					every_ship = { destroy_ship = this } # destroy old, titanic fleet
					#every_ship = { ship_event = { id = trait_regulation.3 } } # destroy old, titanic fleet
		create_fleet = {	# create new not-titanic fleet
			effect = {
				set_owner = prev

				create_ship = {
					name = random
					random_existing_design = science
				}

				set_fleet_stance = evasive				
				set_location = prev.capital_scope
				
				owner = {
					create_leader = {
						type = scientist
						sub_type = survey
						name = random
						species = owner_main_species
					}
				}
				set_leader = last_created_leader
			}			
		}
			
		#constructor
		create_fleet = {
			effect = {
				set_owner = prev
				
				create_ship = {
					name = random
					random_existing_design = constructor
				}
				
				set_fleet_stance = evasive
				set_location = prev.capital_scope
			}
		}

		#military
		create_fleet = {
			effect = {
				set_owner = prev
				
				while = {
					count = 3
					create_ship = {
						name = random
						random_existing_design = corvette
					}
				}
				
				set_location = prev.capital_scope
			}
		}
	}
				}
				1 = { }
			}
	}
}

ship_event = {
	id = trait_regulation.3
	hide_window = yes
	is_triggered_only = yes


	immediate = {
		fromfrom = {
			fleet = { destroy_fleet = this}
		}
	}
}